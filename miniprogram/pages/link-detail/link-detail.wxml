<!--pages/link-detail/link-detail.wxml-->
<view class="page-container" wx:if="{{!loading && link}}">
  <!-- é“¾æ¥ä¿¡æ¯å¡ç‰‡ -->
  <view class="link-card">
    <image 
      wx:if="{{link.thumbnail}}" 
      class="thumbnail" 
      src="{{link.thumbnail}}" 
      mode="aspectFill"
    ></image>
    
    <view class="link-info">
      <text class="title">{{link.title || 'æ— æ ‡é¢˜'}}</text>
      <text class="description">{{link.description || 'æš‚æ— æè¿°'}}</text>
      
      <view class="meta">
        <text class="source">{{link.source === 'wechat_article' ? 'å…¬ä¼—å·æ–‡ç« ' : link.source === 'wechat_video' ? 'å¾®ä¿¡è§†é¢‘' : 'å¤–éƒ¨é“¾æ¥'}}</text>
        <text class="time">{{link.createTimeStr}}</text>
      </view>

      <view class="tags" wx:if="{{link.tags && link.tags.length > 0}}">
        <text class="tag" wx:for="{{link.tags}}" wx:key="*this">{{item}}</text>
      </view>

      <view class="category-row" wx:if="{{link.category}}">
        <text class="label">åˆ†ç±»ï¼š</text>
        <text class="category-tag">{{link.category}}</text>
      </view>

      <view class="summary" wx:if="{{link.summary}}">
        <text class="label">AI æ‘˜è¦ï¼š</text>
        <text class="summary-text">{{link.summary}}</text>
      </view>
    </view>

    <!-- æ“ä½œæŒ‰é’® -->
    <view class="actions">
      <view class="action-btn" bindtap="openLink">
        <text class="action-icon">ğŸ“‹</text>
        <text>å¤åˆ¶é“¾æ¥</text>
      </view>
      <view class="action-btn" bindtap="openInBrowser">
        <text class="action-icon">ğŸ”—</text>
        <text>æ‰“å¼€</text>
      </view>
      <view class="action-btn {{link.isFavorite ? 'active' : ''}}" bindtap="toggleFavorite">
        <text class="action-icon">{{link.isFavorite ? 'â­' : 'â˜†'}}</text>
        <text>{{link.isFavorite ? 'å·²æ”¶è—' : 'æ”¶è—'}}</text>
      </view>
      <view class="action-btn delete" bindtap="deleteLink">
        <text class="action-icon">ğŸ—‘ï¸</text>
        <text>åˆ é™¤</text>
      </view>
    </view>
  </view>

  <!-- ç‚¹è¯„åŒºåŸŸ -->
  <view class="comment-section">
    <view class="section-title">æˆ‘çš„ç‚¹è¯„</view>
    
    <!-- è¯„åˆ† -->
    <view class="rating-row">
      <text class="label">è¯„åˆ†ï¼š</text>
      <view class="rating-stars">
        <view 
          wx:for="{{[1,2,3,4,5]}}" 
          wx:key="*this"
          class="star {{rating >= item ? 'active' : ''}}"
          data-rating="{{item}}"
          bindtap="onRatingChange"
        >
          {{rating >= item ? 'â˜…' : 'â˜†'}}
        </view>
      </view>
    </view>

    <!-- ç‚¹è¯„å†…å®¹ -->
    <view class="comment-input-wrap">
      <textarea 
        class="comment-input"
        placeholder="å†™ä¸‹ä½ å¯¹è¿™ä¸ªé“¾æ¥çš„æƒ³æ³•..."
        value="{{commentContent}}"
        bindinput="onCommentInput"
        maxlength="500"
      ></textarea>
      <text class="char-count">{{commentContent.length}}/500</text>
    </view>

    <button class="save-btn" bindtap="saveComment">ä¿å­˜ç‚¹è¯„</button>
  </view>
</view>

<!-- åŠ è½½çŠ¶æ€ -->
<view class="loading" wx:if="{{loading}}">
  <text>åŠ è½½ä¸­...</text>
</view>
